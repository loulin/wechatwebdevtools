"use strict";function init(){var e=require("../../lib/react.js"),t=require("../../cssStr/cssStr.js"),i=require("../../stroes/webviewStores.js"),s=require("../../common/jssdk/sdkNameTrans.js"),r=e.createClass({displayName:"Purview",getInitialState:function(){return{webviewID:0,list:{0:{purviewList:[],noPurviewList:[],appId:""}}}},_deleteWebviewID:function(e){delete this.state.list[e]},_changeWebviewID:function(e){this.setState({webviewID:e})},_webviewSDK:function(e,t,i,s,r){if("openUrlWithExtraWebview"===i){webviewNum++;var n=Object.assign({},this.state.list);n[webviewNum]={purviewList:[],noPurviewList:[],appId:""},this.setState({webviewID:webviewNum,list:n})}},_cleanWebview:function(e){var t=Object.assign({},this.state.list);t[e]={purviewList:[],noPurviewList:[],appId:""},this.setState({list:t})},_getJSSDKLog:function(e,t,i,s,r){if("PREVERIFY_SDK"===r.type){for(var n=[],a=t.args.verifyJsApiList,v=0,l=a.length;v<l;v++){var o=a[v];r.purviewFromPreVerify[o]||n.push(o)}for(var u=[],w=r.purviewFormGetA8key,p=r.defaultPurview,c=[],h=0,m=n.length;h<m;h++){var E=n[h];w[E]||p[E]?u.push(E):c.push(E)}var d=Object.assign({},this.state.list);d[e]={appId:t.args.appId,purviewList:u,noPurviewList:c},this.setState({list:d})}},componentDidMount:function(){i.on("DELETE_WEBVIEW_ID",this._deleteWebviewID),i.on("WEBVIEW_SDK",this._webviewSDK),i.on("CLEAN_WEBVIEW",this._cleanWebview),i.on("GET_JASSDK_LOG",this._getJSSDKLog)},componentWillUnmount:function(){i.removeListener("DELETE_WEBVIEW_ID",this._deleteWebviewID),i.removeListener("CHANGE_WEBVIEW_ID",this._changeWebviewID),i.removeListener("WEBVIEW_SDK",this._webviewSDK),i.removeListener("CLEAN_WEBVIEW",this._cleanWebview),i.removeListener("GET_JASSDK_LOG",this._getJSSDKLog)},makeNodes:function(t){var i=[];t.forEach(function(e,t){t%3===0&&(i[i.length]=[]),i[i.length-1].push(e)});var r=i.map(function(t){var i=t.map(function(t){return e.createElement("div",{className:"purview-log-item"},s.getSdkDisplayName(t))});return e.createElement("div",{className:"purview-log"},i)});return r},render:function(){var i=this.state.webviewID,s=this.state.list[i].purviewList,r=this.state.list[i].noPurviewList,n=this.state.list[i].appId,a="purview"===this.props.show?{}:t.displayNone,v=this.makeNodes(s),l=this.makeNodes(r);return e.createElement("div",{className:"purview",style:a},e.createElement("div",{className:"purview-hd"},e.createElement("h4",null,"AppID: ",n),e.createElement("p",null,"通过 wx.config 获取的权限如下:")),e.createElement("div",{className:"purview-bd"},v),e.createElement("div",{className:"purview-hd",style:l.length?{}:t.displayNone},e.createElement("p",null,"未获取到的权限如下:")),e.createElement("div",{className:"purview-bd",style:l.length?{}:t.displayNone},l))}});_exports=r}var _exports;init(),module.exports=_exports;